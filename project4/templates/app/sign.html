{% block title %}회원가입{% endblock title %}

{% block content %}
<style>
  :root{
    --bg-dark:#0d0d0d; --modal:#eeeeee; --text:#111;
    --radius:14px; --shadow:0 10px 30px rgba(0,0,0,.35);
    --accent:#2b2b2b; --muted:#cfcfcf; --danger:#cf2c2c;
  }
  body{margin:0}
  .auth-wrap{
    min-height:calc(100vh - 0px);
    background:
      radial-gradient(1200px 220px at 50% 0%, #000000a0, transparent 60%),
      linear-gradient(#2a2a2a,#1e1e1e);
    display:grid; place-items:center; padding:24px;
  }
  .modal{
    width:min(420px,92vw);
    background:var(--modal);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    padding:16px 16px 18px;
    position:relative;
    color:var(--text);
  }
  .modal-head{
    display:flex; align-items:center; justify-content:space-between;
    margin-bottom:8px;
  }
  .icon-btn{
    width:32px;height:32px;border-radius:50%;
    display:grid;place-items:center;
    background:#fff;border:1px solid #d9d9d9;cursor:pointer;
  }
  .title{font-weight:900; text-align:center; flex:1}
  .x{font-weight:900}

  .err-list{color:var(--danger); margin:6px 0 10px; padding-left:18px}
  .field{margin:10px 0}
  .label{font-size:14px; font-weight:700; margin-bottom:6px; display:block}
  .input{
    width:100%; height:42px; border-radius:10px;
    border:1px solid #d0d0d0; padding:0 12px; background:#fff; outline:none;
  }
  .hint-danger{color:var(--danger); font-size:12px; line-height:1.5; margin-top:6px}
  .agree{display:flex; gap:8px; align-items:flex-start; margin:12px 0 2px}
  .links{font-size:12px; color:#333; margin-top:4px}
  .links a{color:#1e5eff; text-decoration:underline}

  .btn{
    width:100%; height:46px; border:none; border-radius:10px; cursor:pointer;
    background:var(--accent); color:#fff; font-weight:800;
    transition:opacity .15s ease;
  }
  .btn:disabled{opacity:.45; cursor:not-allowed}
  .foot{margin-top:12px; font-size:14px; text-align:center}
  .foot a{text-decoration:underline; color:#1e5eff}
</style>

<div class="auth-wrap">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="signupTitle">
    <div class="modal-head">
      <button class="icon-btn" type="button" onclick="location.href='{% url 'app:login' %}'" aria-label="뒤로가기">←</button>
      <div class="title" id="signupTitle">회원가입</div>
      <button class="icon-btn x" type="button" onclick="location.href='/'" aria-label="닫기">×</button>
    </div>

    {# 서버 메시지(유효성, 중복 등) 빨간색 표시 #}
    {% if messages %}
      <ul class="err-list">
        {% for message in messages %}
          <li>{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    {# 시작 화면: 이메일 인증 단계로 이동 (약관 체크 후) #}
    <div class="field">
      <span class="label">이메일 인증 안내</span>
      <div class="hint-danger">
        가입 진행은 먼저 이메일을 확인하고 인증코드를 입력합니다.<br>
        다음 단계에서 비밀번호를 설정합니다.
      </div>
    </div>

    <label class="agree">
      <input type="checkbox" id="agree_terms">
      <span>이용약관에 동의합니다.</span>
    </label>
    <div class="links">
      <a href="{% url 'app:terms' %}" target="_blank" rel="noopener">약관 보기</a>
    </div>

    <div style="margin-top:14px">
      <button class="btn" id="go_email_btn" disabled>이메일 인증으로 이동</button>
    </div>

    <div class="foot">
      이미 계정이 있나요?
      <a href="{% url 'app:login' %}">로그인</a>
    </div>
  </div>
</div>

<script>
  (function(){
    const agree = document.getElementById('agree_terms');
    const go = document.getElementById('go_email_btn');
    const toggle = () => go.disabled = !agree.checked;
    agree.addEventListener('change', toggle); toggle();

    go.addEventListener('click', function(){
      window.location.href = "{% url 'app:email' %}"; // email.html 라우트
    });
  })();
</script>
{% endblock content %}